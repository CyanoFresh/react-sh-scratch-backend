(window["webpackJsonpsh-frontend"]=window["webpackJsonpsh-frontend"]||[]).push([[23],{204:function(e,t,a){e.exports=a(317)},228:function(e,t){},230:function(e,t){},302:function(e,t){},303:function(e,t){},310:function(e,t,a){var n={"./buzzer":[96,4,5],"./buzzer/":[96,4,5],"./buzzer/HistoryModal":[189,12],"./buzzer/HistoryModal.js":[189,12],"./buzzer/Notification":[190,14],"./buzzer/Notification.js":[190,14],"./buzzer/Widget":[191,15],"./buzzer/Widget.js":[191,15],"./buzzer/constants":[183,17],"./buzzer/constants.js":[183,17],"./buzzer/index":[96,4,5],"./buzzer/index.js":[96,4,5],"./motion-switch":[97,6,10],"./motion-switch/":[97,6,10],"./motion-switch/index":[97,6,10],"./motion-switch/index.js":[97,6,10],"./plant":[98,3,9],"./plant/":[98,3,9],"./plant/HistoryItem":[192,13],"./plant/HistoryItem.js":[192,13],"./plant/Modal":[198,3],"./plant/Modal.js":[198,3],"./plant/Widget":[193,18],"./plant/Widget.js":[193,18],"./plant/constants":[185,19],"./plant/constants.js":[185,19],"./plant/index":[98,3,9],"./plant/index.js":[98,3,9],"./rgb":[99,0,2,7],"./rgb/":[99,0,2,7],"./rgb/Dialog":[194,0,2,16],"./rgb/Dialog.js":[194,0,2,16],"./rgb/constants":[184,20],"./rgb/constants.js":[184,20],"./rgb/index":[99,0,2,7],"./rgb/index.js":[99,0,2,7],"./switch":[100,11],"./switch/":[100,11],"./switch/index":[100,11],"./switch/index.js":[100,11],"./variable":[101,0,1,8],"./variable/":[101,0,1,8],"./variable/HistoryModal":[195,0,1,21],"./variable/HistoryModal.js":[195,0,1,21],"./variable/Widget":[196,22],"./variable/Widget.js":[196,22],"./variable/index":[101,0,1,8],"./variable/index.js":[101,0,1,8]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return Promise.all(t.slice(1).map(a.e)).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=310,e.exports=r},311:function(e,t,a){var n={".":9,"./":9,"./Auth":81,"./Auth.js":81,"./UserData":75,"./UserData.js":75,"./index":9,"./index.js":9,"./useFetch":48,"./useFetch.js":48};function r(e){return Promise.resolve().then((function(){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}var r=n[e];return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=311,e.exports=r},317:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(11),c=a.n(o),i=a(22),s=a(52),l=a(392),u=a(77),m=a(9);var d=function(e){var t=e.component,a=Object(u.a)(e,["component"]);return r.a.createElement(s.b,Object.assign({},a,{render:function(e){return m.default.auth.isAuthenticated()?r.a.createElement(t,e):r.a.createElement(s.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},p=a(12),f=a.n(p),b=a(18),h=a(10),g=a(373),v=a(379),E=a(374),O=a(378),j=a(395),y=a(170),w=a.n(y),k=a(76),x=a(169),S=a(372),P=a(324),D=Object(x.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),C=function(e){var t=e.location,a=r.a.useState(""),n=Object(h.a)(a,2),o=n[0],c=n[1],i=r.a.useState(""),l=Object(h.a)(i,2),u=l[0],d=l[1],p=r.a.useState(!1),y=Object(h.a)(p,2),x=y[0],C=y[1],N=r.a.useState(!1),_=Object(h.a)(N,2),z=_[0],T=_[1],I=r.a.useState(!1),L=Object(h.a)(I,2),W=L[0],F=L[1],U=r.a.useState(null),q=Object(h.a)(U,2),R=q[0],H=q[1],M=D(),A=function(){var e=Object(b.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),T(!0),e.prev=2,e.next=5,m.default.auth.login(o,u,x);case 5:e.sent?(T(!1),F(!0)):H("Error"),e.next=15;break;case 9:e.prev=9,e.t0=e.catch(2),T(!1),a=e.t0.message,e.t0.response&&e.t0.response.data&&e.t0.response.data.message&&(a=e.t0.response.data.message),H(a);case 15:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),B=(t.state||{from:{pathname:"/"}}).from;return W?r.a.createElement(s.a,{to:B}):r.a.createElement(S.a,{component:"main",maxWidth:"xs"},r.a.createElement("div",{className:M.paper},r.a.createElement(g.a,{className:M.avatar},r.a.createElement(w.a,null)),r.a.createElement(k.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:M.form,onSubmit:A},r.a.createElement(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Username",name:"username",autoComplete:"username",value:o,onChange:function(e){return c(e.target.value)},autoFocus:!0}),r.a.createElement(E.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",value:u,onChange:function(e){return d(e.target.value)},autoComplete:"current-password"}),r.a.createElement(O.a,{control:r.a.createElement(j.a,{value:"remember",color:"primary",checked:x,onChange:function(e){return C(e.target.checked)}}),label:"Remember me"}),R&&r.a.createElement(P.a,{error:!0},R),r.a.createElement(v.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:M.submit},z?"Loading...":"Sign In"))))},N=a(20),_=a(19),z=a(387),T=a(388),I=a(325),L=a(177),W=a.n(L),F=a(179),U=a(389),q=a(178),R=a.n(q),H=a(398),M=a(396),A=a(380),B=a(393),G=a(323),J=Object(x.a)((function(e){return{root:{padding:e.spacing(2,3),borderRadius:4*e.shape.borderRadius},title:{marginBottom:e.spacing()},itemGroup:{marginBottom:e.spacing()}}})),K=function(e){var t=e.id,a=e.module,n=Object(u.a)(e,["id","module"]),o=m.default.modules[a];return r.a.createElement(o.default,Object.assign({key:t,core:m.default},o.config,{id:t},n))},$=function(e){var t=e.items,a=J();return r.a.createElement(A.a,{container:!0,spacing:1,className:a.itemGroup},t.map((function(e){return r.a.createElement(K,Object.assign({key:e.id},e))})))},Q=function(e){var t=e.name,a=e.items,n=J();return r.a.createElement(A.a,{item:!0,lg:6,md:6,sm:12,xs:12},r.a.createElement(G.a,{className:n.root,elevation:2},r.a.createElement(k.a,{variant:"h5",component:"h3",className:n.title},t),a.map((function(e,t){return r.a.createElement($,{key:t,items:e})}))))},V=a(381),X=a(3),Y=Object(x.a)((function(e){return{root:{display:"flex",justifyContent:"center"},full:{padding:e.spacing(10,0)},small:{padding:e.spacing(1,0)},hidden:{opacity:0}}})),Z=function(e){var t=e.delay,a=void 0===t?1e3:t,o=e.size,c=void 0===o?100:o,i=e.thickness,s=void 0===i?2.6:i,l=e.variant,u=void 0===l?"full":l,m=Y(),d=Object(n.useState)(!Boolean(a)),p=Object(h.a)(d,2),f=p[0],b=p[1];return Object(n.useEffect)((function(){if(a){var e=setTimeout((function(){return b(!0)}),a);return function(){return clearTimeout(e)}}})),r.a.createElement("div",{className:Object(X.a)(m.root,m[u],Object(N.a)({},m.hidden,!f))},r.a.createElement(V.a,{size:c,thickness:s}))},ee=function(e){var t=Object(n.useState)(!0),a=Object(h.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)(null),s=Object(h.a)(i,2),l=s[0],u=s[1],d=Object(n.useState)([]),p=Object(h.a)(d,2),g=p[0],v=p[1];return Object(n.useEffect)((function(){var t=function(){var t=Object(b.a)(f.a.mark((function t(){var a,n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(!0),a=e.match.params.dashboard||"main",console.log("Loading dashboard data for id ".concat(a,"...")),t.prev=3,t.next=6,m.default.authenticatedRequest({url:"/dashboard/".concat(a),method:"get",responseType:"json"});case 6:if((n=t.sent).data.ok){t.next=11;break}return c(!1),u("Invalid dashboard data"),t.abrupt("return");case 11:return console.log(n.data),t.next=14,m.default.loadModules(n.data.modules);case 14:c(!1),u(null),v(n.data.items),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(3),c(!1),u(t.t0.message);case 23:case"end":return t.stop()}}),t,null,[[3,19]])})));return function(){return t.apply(this,arguments)}}(),a=function(){console.log("Dashboard socket offline"),c(!0)};return m.default.on("connect",t),m.default.on("disconnect",a),m.default.socket&&m.default.socket.connected&&t(),function(){m.default.off("connect",t),m.default.off("disconnect",a)}}),[e.match.params.dashboard]),o?r.a.createElement(Z,null):l?r.a.createElement(B.a,{bgcolor:"error.main",color:"background.paper",p:2},l):r.a.createElement(A.a,{container:!0,spacing:2},g.map((function(e){return r.a.createElement(Q,Object.assign({key:e.id},e))})))},te=function(){return r.a.createElement(k.a,{variant:"h3"},"404 \u2014 Not Found")},ae=a(377),ne=a(326),re=a(173),oe=a.n(re),ce=a(383),ie=a(384),se=a(48),le=a(385),ue=a(174),me=a.n(ue),de=Object(x.a)((function(e){return{paper:{padding:e.spacing(2,3)},header:{},fab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}})),pe=function(e){var t=e.match,a=de(),n=Object(se.default)({url:"/users",method:"GET",responseType:"json"},[]),o=Object(h.a)(n,1)[0],c=o.data,s=o.isLoading,l=o.error;return s?r.a.createElement(Z,null):l?r.a.createElement(B.a,{bgcolor:"error.main",color:"background.paper",p:2},l):r.a.createElement(A.a,{item:!0,md:6},r.a.createElement(G.a,{className:a.paper},r.a.createElement("div",{className:a.header},r.a.createElement(k.a,{variant:"h5",component:"h3"},"Users")),r.a.createElement(ae.a,null,c.users.map((function(e){return r.a.createElement(ne.a,{button:!0,key:e.id,component:i.b,to:"".concat(t.url,"/").concat(e.id)},r.a.createElement(ce.a,null,r.a.createElement(oe.a,null)),r.a.createElement(ie.a,{primary:e.name+" \u2014 "+e.user_id,secondary:e.room_id}))})))),r.a.createElement(le.a,{color:"primary","aria-label":"add",className:a.fab,component:i.b,to:"/users/create"},r.a.createElement(me.a,null)))},fe=a(322);function be(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function he(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?be(a,!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):be(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ge=Object(x.a)((function(e){return{paper:{padding:e.spacing(3)}}})),ve={user_id:"",name:"",room_id:"",password:"",api_key:"",last_login_at:0},Ee=function(e){var t=e.match,a=ge(),o=t.params.userId,c=Object(se.default)({url:"/users/".concat(o),method:"GET",responseType:"json"},{user:ve}),i=Object(h.a)(c,1)[0],l=i.data,u=i.isLoading,d=i.error,p=Object(n.useState)(ve),g=Object(h.a)(p,2),O=g[0],j=g[1],y=Object(n.useState)(!1),w=Object(h.a)(y,2),x=w[0],S=w[1];Object(n.useEffect)((function(){j((function(e){return he({},e,{},l.user)}))}),[l.user]);var P=function(e){return j(he({},O,Object(N.a)({},e.target.name,e.target.value)))},D=function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,m.default.authenticatedRequest({url:"/users/".concat(o),method:"PUT",responseType:"json",data:O});case 4:a=e.sent,n=a.data,S(n.ok),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return x?r.a.createElement(s.a,{to:"/users"}):u?r.a.createElement(Z,null):d?r.a.createElement(B.a,{bgcolor:"error.main",color:"background.paper",p:2},d):r.a.createElement(A.a,{item:!0,md:6},r.a.createElement(G.a,{className:a.paper},r.a.createElement(k.a,{variant:"h5",component:"h3"},"Edit ",l.user.name||l.user.user_id),r.a.createElement("form",{className:a.form,onSubmit:D},r.a.createElement(E.a,{name:"user_id",label:"User ID",value:O.user_id,margin:"normal",variant:"filled",InputProps:{readOnly:!0},fullWidth:!0}),r.a.createElement(E.a,{required:!0,name:"name",label:"Name",autoComplete:"name",value:O.name,onChange:P,margin:"normal",variant:"filled",fullWidth:!0}),r.a.createElement(E.a,{name:"password",label:"New Password",value:O.password,onChange:P,margin:"normal",variant:"filled",type:"password",autoComplete:"new-password",fullWidth:!0}),r.a.createElement(E.a,{name:"api_key",label:"API Key",value:O.api_key||"",onChange:P,margin:"normal",variant:"filled",fullWidth:!0}),r.a.createElement(E.a,{name:"room_id",label:"Room ID",value:O.room_id||"",onChange:P,margin:"normal",variant:"filled",fullWidth:!0}),r.a.createElement(E.a,{label:"Last Login",value:new Date(1e3*O.last_login_at).toLocaleString(),margin:"normal",variant:"filled",InputProps:{readOnly:!0},fullWidth:!0}),r.a.createElement(fe.a,{margin:"normal"},r.a.createElement(v.a,{type:"submit",color:"primary",variant:"contained"},"Save")))))};function Oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var je=Object(x.a)((function(e){return{paper:{padding:e.spacing(3)}}})),ye=function(e){e.match;var t=je(),a=Object(n.useState)({user_id:"",name:"",password:"",api_key:"",room_id:""}),o=Object(h.a)(a,2),c=o[0],i=o[1],l=Object(n.useState)(!1),u=Object(h.a)(l,2),d=u[0],p=u[1],g=function(e){i(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oe(a,!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Oe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},c,Object(N.a)({},e.target.name,e.target.value)))},O=function(){var e=Object(b.a)(f.a.mark((function e(t){var a,n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,m.default.authenticatedRequest({url:"/users",method:"POST",responseType:"json",data:c});case 4:a=e.sent,n=a.data,p(n.ok),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return d?r.a.createElement(s.a,{to:"/users"}):r.a.createElement(A.a,{item:!0,md:6},r.a.createElement(G.a,{className:t.paper},r.a.createElement(k.a,{variant:"h5",component:"h3"},"Create User"),r.a.createElement("form",{className:t.form,onSubmit:O},r.a.createElement(E.a,{required:!0,name:"user_id",label:"User ID",value:c.user_id,onChange:g,margin:"normal",variant:"filled",fullWidth:!0}),r.a.createElement(E.a,{required:!0,name:"name",label:"Name",autoComplete:"name",value:c.name,onChange:g,margin:"normal",variant:"filled",fullWidth:!0}),r.a.createElement(E.a,{required:!0,name:"password",label:"New Password",value:c.password,onChange:g,margin:"normal",variant:"filled",type:"password",autoComplete:"new-password",fullWidth:!0}),r.a.createElement(E.a,{name:"api_key",label:"API Key",value:c.api_key,onChange:g,margin:"normal",variant:"filled",fullWidth:!0}),r.a.createElement(E.a,{name:"room_id",label:"Room ID",value:c.room_id,onChange:g,margin:"normal",variant:"filled",fullWidth:!0}),r.a.createElement(fe.a,{margin:"normal"},r.a.createElement(v.a,{type:"submit",color:"primary",variant:"contained"},"Create")))))},we=function(e){var t=e.match;return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.a,{container:!0,spacing:4},r.a.createElement(s.b,{path:t.path,exact:!0,component:pe}),r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"".concat(t.path,"/create"),component:ye}),r.a.createElement(s.b,{path:"".concat(t.path,"/:userId"),component:Ee}))))},ke=a(397),xe=function(){var e=Object(se.default)({url:"/dashboards",method:"GET",responseType:"json"},[]),t=Object(h.a)(e,1)[0],a=t.data,n=t.isLoading,o=t.error;return n?r.a.createElement(Z,{size:35,thickness:3,variant:"small"}):o?r.a.createElement(B.a,{p:2},o):r.a.createElement(ae.a,null,a.dashboards.map((function(e){return r.a.createElement(ne.a,{button:!0,key:e.id,component:i.b,to:"/".concat(e.id)},r.a.createElement(ce.a,null,r.a.createElement(ke.a,null)),r.a.createElement(ie.a,{primary:e.name}))})))},Se=a(386),Pe=a(175),De=a.n(Pe),Ce=a(176),Ne=a.n(Ce),_e=function(e){var t=e.onLogout;return r.a.createElement(r.a.Fragment,null,r.a.createElement(xe,null),r.a.createElement(Se.a,null),r.a.createElement(ae.a,null,r.a.createElement(ne.a,{button:!0,component:i.b,to:"/users"},r.a.createElement(ce.a,null,r.a.createElement(De.a,null)),r.a.createElement(ie.a,{primary:"Users"})),r.a.createElement(ne.a,{button:!0,onClick:t},r.a.createElement(ce.a,null,r.a.createElement(Ne.a,null)),r.a.createElement(ie.a,{primary:"Logout"}))))},ze=Object(x.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},menuButton:Object(N.a)({marginRight:e.spacing(2)},e.breakpoints.up("md"),{display:"none"}),drawer:Object(N.a)({},e.breakpoints.up("md"),{width:240,flexShrink:0}),drawerPaper:{width:240},title:{flexGrow:1,fontFamily:"Product Sans",fontWeight:"normal"},content:Object(N.a)({flexGrow:1,padding:e.spacing(3)},e.breakpoints.down("sm"),{padding:e.spacing(1)}),toolbar:e.mixins.toolbar}})),Te=function(e){var t=e.history,a=ze(),o=Object(_.a)(),c=r.a.useState(null),i=Object(h.a)(c,2),l=i[0],u=i[1],d=r.a.useState(!1),p=Object(h.a)(d,2),g=p[0],v=p[1],E=Boolean(l),O=function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([m.default.auth.signOut(),m.default.disconnect()]);case 2:t.push("/");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function j(){v(!g)}return Object(n.useEffect)((function(){var e=function(){var e=Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Socket connected");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return m.default.connect(),m.default.socket.on("connect",e),function(){m.default.socket.off("connect",e)}}),[]),r.a.createElement("div",{className:a.root},r.a.createElement(z.a,{position:"fixed",className:a.appBar},r.a.createElement(T.a,null,r.a.createElement(I.a,{edge:"start",className:a.menuButton,onClick:j,color:"inherit","aria-label":"open drawer"},r.a.createElement(W.a,null)),r.a.createElement(k.a,{variant:"h6",className:a.title},"Solomaha Home"),r.a.createElement("div",null,r.a.createElement(I.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){u(e.currentTarget)},color:"inherit"},r.a.createElement(R.a,null)),r.a.createElement(F.a,{id:"menu-appbar",anchorEl:l,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:E,onClose:function(){u(null)},PaperProps:{style:{width:200}}},r.a.createElement(U.a,{disabled:!0,divider:!0},"Logged in as ",m.default.auth.userData.name),r.a.createElement(U.a,{onClick:O},"Log Out"))))),r.a.createElement("nav",{className:a.drawer,"aria-label":"mailbox folders"},r.a.createElement(M.a,{mdUp:!0,implementation:"css"},r.a.createElement(H.a,{variant:"temporary",open:g,anchor:"rtl"===o.direction?"right":"left",onClose:j,classes:{paper:a.drawerPaper},ModalProps:{keepMounted:!0}},r.a.createElement(_e,{onLogout:O}))),r.a.createElement(M.a,{smDown:!0,implementation:"css"},r.a.createElement(H.a,{classes:{paper:a.drawerPaper},variant:"permanent",open:!0},r.a.createElement("div",{className:a.toolbar}),r.a.createElement(_e,{onLogout:O})))),r.a.createElement("main",{className:a.content},r.a.createElement("div",{className:a.toolbar}),r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/users",component:we}),r.a.createElement(s.b,{path:"/:dashboard?",exact:!0,component:ee}),r.a.createElement(s.b,{component:te}))))};var Ie=function(){return r.a.createElement(i.a,null,r.a.createElement(l.a,null),r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/login",exact:!0,component:C}),r.a.createElement(d,{path:"/",component:Te}),r.a.createElement(s.b,{component:te})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));window.sh=m.default,c.a.render(r.a.createElement(Ie,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},48:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),o=a(18),c=a(10),i=a(20),s=a(0),l=a(9);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(a,!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d=function(e,t){switch(t.type){case"FETCH_INIT":return m({},e,{isLoading:!0,error:null});case"FETCH_SUCCESS":return m({},e,{isLoading:!1,error:!1,data:t.payload});case"FETCH_FAILURE":return m({},e,{isLoading:!1,error:t.payload});default:throw new Error}};t.default=function(e,t){var a=Object(s.useState)(e),n=Object(c.a)(a,2),i=n[0],u=n[1],m=Object(s.useReducer)(d,{isLoading:!0,error:null,data:t}),p=Object(c.a)(m,2),f=p[0],b=p[1];return Object(s.useEffect)((function(){var e=!1;return function(){var t=Object(o.a)(r.a.mark((function t(){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b({type:"FETCH_INIT"}),t.prev=1,t.next=4,l.default.authenticatedRequest(i);case 4:a=t.sent,e||(a.data.ok?b({type:"FETCH_SUCCESS",payload:a.data}):b({type:"FETCH_FAILURE",payload:"Wrong server response"})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e||b({type:"FETCH_FAILURE",payload:t.t0.message});case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(){return t.apply(this,arguments)}}()(),function(){e=!0}}),[i]),[f,u]}},75:function(e,t,a){"use strict";a.r(t);var n=a(64),r=a(65),o=function(){function e(t,a,r){Object(n.a)(this,e),this.id=t,this.name=a,this.token=r}return Object(r.a)(e,null,[{key:"createFromData",value:function(t){return new e(t.id,t.name,t.token)}}]),e}();t.default=o},81:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),o=a(18),c=a(64),i=a(65),s=a(75),l=function(){function e(t){Object(c.a)(this,e),this.core=t,this.loadFromStorage()}return Object(i.a)(e,[{key:"isAuthenticated",value:function(){return Boolean(this.userData)}},{key:"getToken",value:function(){return this.userData&&this.userData.token}},{key:"loadFromStorage",value:function(){var t;(t=localStorage.getItem(e.storageKey))?this.storage=localStorage:(t=sessionStorage.getItem(e.storageKey))&&(this.storage=sessionStorage);try{var a=JSON.parse(t);a&&(this.userData=s.default.createFromData(a))}catch(n){this.userData=null}}},{key:"login",value:function(){var t=Object(o.a)(r.a.mark((function t(a,n,o){var c,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.axios.request({url:"/auth/login",method:"post",data:{username:a,password:n,remember:o},responseType:"json"});case 2:if(c=t.sent,!(i=c.data).ok||!i.user){t.next=10;break}return this.storage=o?localStorage:sessionStorage,this.userData=s.default.createFromData(i.user),this.storage.setItem(e.storageKey,JSON.stringify(this.userData)),this.core.emit("authenticated",this.userData),t.abrupt("return",this.userData);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,this)})));return function(e,a,n){return t.apply(this,arguments)}}()},{key:"signOut",value:function(){var t=Object(o.a)(r.a.mark((function t(){var a,n,o,c=arguments;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!(c.length>0&&void 0!==c[0])||c[0],a=this.userData.token,this.storage.removeItem(e.storageKey),this.userData=null,t.prev=4,t.next=7,this.core.authenticatedRequest({url:"auth/logout",method:"post",responseType:"json"},a);case 7:return n=t.sent,o=n.data,t.abrupt("return",o.ok);case 12:return t.prev=12,t.t0=t.catch(4),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,this,[[4,12]])})));return function(){return t.apply(this,arguments)}}()}]),e}();l.storageKey="user",t.default=l},9:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a.n(n),o=a(18),c=a(20),i=a(64),s=a(65),l=a(119),u=a(117),m=a(82),d=a(118),p=a(81),f=a(55),b=a(166),h=a.n(b),g=a(167);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function E(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(a,!0).forEach((function(t){Object(c.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).modules={},e.auth=new p.default(Object(m.a)(e)),e.axios=h.a.create({baseURL:"//home.solomaha.com/api"}),e}return Object(d.a)(t,e),Object(s.a)(t,[{key:"authenticatedRequest",value:function(e,t){return this.axios.request(E({},e,{headers:E({Authorization:t||this.auth.getToken()},e.headers)}))}},{key:"connect",value:function(){var e=this;if(!this.auth.isAuthenticated())return console.error("Connect requires authentication"),!1;if(this.socket)this.socket.reconnect();else{var t=this.auth.userData.id+"@"+(Date.now()/1e3|0);this.socket=Object(g.connect)("mqtts://home.solomaha.com/mqtt_wss",{clientId:t,username:"user",password:this.auth.userData.token}),this.socket.on("connect",(function(){return e.emit("connect")})),this.socket.on("offline",(function(){return e.emit("disconnect")})),this.socket.on("disconnect",(function(){return e.emit("disconnect")})),this.socket.on("close",(function(){return e.emit("disconnect")})),this.socket.on("message",(function(t,a){try{var n=JSON.parse(a.toString());console.log("Socket json:",t,n),e.emit("topic-".concat(t),n)}catch(r){console.log("Socket: ",a,r),e.emit("message",a,t)}}))}}},{key:"disconnect",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(a){return e.socket.end(t,a)}))}},{key:"subscribe",value:function(e,t){this.socket.subscribe(e),this.on("topic-".concat(e),t)}},{key:"unsubscribe",value:function(e,t){this.socket.unsubscribe(e),this.removeListener("topic-".concat(e),t)}},{key:"publishJson",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.socket.publish(e,JSON.stringify(t),a,n)}},{key:"loadModules",value:function(){var e=Object(o.a)(r.a.mark((function e(t){var n,o=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.filter((function(e){return!o.modules.hasOwnProperty(e.id)})),e.next=3,Promise.all(n.map((function(e){return e.local?a(310)("./".concat(e.id)):a(311)("".concat(e.id))})));case 3:e.sent.forEach((function(e,a){var n=t[a];o.modules[n.id]=e,o.modules[n.id].config=n}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),t}(f.EventEmitter);t.default=new O}},[[204,24,25]]]);