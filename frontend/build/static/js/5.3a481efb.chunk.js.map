{"version":3,"sources":["modules/buzzer/constants.js","modules/buzzer/HistoryModal.js","modules/buzzer/Notification.js","modules/buzzer/Widget.js","modules/buzzer/index.js"],"names":["HISTORY_TYPES","RINGING","UNLOCKED","AUTO_UNLOCKED","HISTORY_TYPES_LABELS","_HISTORY_TYPES_LABELS","Object","D_JS_sh_frontend_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","HistoryItems","_ref","id","name","core","open","onClose","_useState","useState","_useState2","D_JS_sh_frontend_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","data","setData","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","error","setError","useMemo","_ref2","D_JS_sh_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","D_JS_sh_frontend_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee","response","wrap","_context","prev","next","authenticatedRequest","url","concat","responseType","method","sent","ok","abrupt","history","t0","console","stop","apply","this","arguments","loadHistory","react__WEBPACK_IMPORTED_MODULE_8___default","createElement","_material_ui_core_Box__WEBPACK_IMPORTED_MODULE_10__","bgcolor","color","p","_material_ui_core__WEBPACK_IMPORTED_MODULE_9__","length","_material_ui_core_List__WEBPACK_IMPORTED_MODULE_13__","map","historyItem","_material_ui_core_ListItem__WEBPACK_IMPORTED_MODULE_15__","key","date","_material_ui_core_ListItemAvatar__WEBPACK_IMPORTED_MODULE_20__","_material_ui_core_Avatar__WEBPACK_IMPORTED_MODULE_16__","type","_material_ui_icons_PhoneInTalk__WEBPACK_IMPORTED_MODULE_17___default","_material_ui_icons_LockOpen__WEBPACK_IMPORTED_MODULE_18___default","_material_ui_core_ListItemText__WEBPACK_IMPORTED_MODULE_14__","primary","secondary","Date","toLocaleString","HistoryModal","_ref3","theme","useTheme","fullScreen","useMediaQuery","breakpoints","down","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_3__","fullWidth","maxWidth","aria-labelledby","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_5__","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_7__","onClick","useStyles","makeStyles","close","padding","spacing","__webpack_exports__","isRinging","classes","D_JS_sh_frontend_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","isRingingOpen","setIsRingingOpen","text","msg","setMsg","useEffect","onUnlocked","label","onAutoUnlockUpdate","subscribe","unsubscribe","handleMsgClose","react__WEBPACK_IMPORTED_MODULE_1___default","Fragment","_material_ui_core_Snackbar__WEBPACK_IMPORTED_MODULE_2__","anchorOrigin","vertical","horizontal","autoHideDuration","message","action","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_3__","aria-label","className","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_4___default","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_5__","size","publishJson","paper","borderRadius","shape","cursor","transition","background","_objectSpread","typography","h6","flexGrow","fontWeight","value","actions","display","unlockBtn","marginRight","hangUpBtn","red","&:hover","Widget","props","D_JS_sh_frontend_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__","isAutoUnlock","setIsAutoUnlock","setIsRinging","onRinging","controls","handleUnlockClick","unlock","react__WEBPACK_IMPORTED_MODULE_5___default","_material_ui_core_Grid__WEBPACK_IMPORTED_MODULE_3__","item","xs","e","stopPropagation","variant","_material_ui_icons_LockOpen__WEBPACK_IMPORTED_MODULE_12___default","_material_ui_icons_CallEnd__WEBPACK_IMPORTED_MODULE_11___default","_material_ui_core_FormControlLabel__WEBPACK_IMPORTED_MODULE_9__","control","_material_ui_core_Switch__WEBPACK_IMPORTED_MODULE_10__","checked","onChange","target","sm","_material_ui_core_Paper__WEBPACK_IMPORTED_MODULE_4__","clsx","D_JS_sh_frontend_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_2__","container","alignContent","openModal","setOpenModal","_Widget__WEBPACK_IMPORTED_MODULE_2__","assign","_HistoryModal__WEBPACK_IMPORTED_MODULE_3__","_Notification__WEBPACK_IMPORTED_MODULE_4__"],"mappings":"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","file":"static/js/5.3a481efb.chunk.js","sourcesContent":["export const HISTORY_TYPES = {\r\n  RINGING: 0,\r\n  UNLOCKED: 1,\r\n  AUTO_UNLOCKED: 2,\r\n};\r\n\r\nexport const HISTORY_TYPES_LABELS = {\r\n  [HISTORY_TYPES.RINGING]: 'ringing',\r\n  [HISTORY_TYPES.UNLOCKED]: 'unlocked',\r\n  [HISTORY_TYPES.AUTO_UNLOCKED]: 'auto-unlocked',\r\n};\r\n","import Dialog from '@material-ui/core/Dialog';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport Button from '@material-ui/core/Button';\r\nimport React, { useMemo, useState } from 'react';\r\nimport { CircularProgress } from '@material-ui/core';\r\nimport Box from '@material-ui/core/Box';\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\r\nimport { useTheme } from '@material-ui/core/styles';\r\nimport List from '@material-ui/core/List';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport CallIcon from '@material-ui/icons/PhoneInTalk';\r\nimport LockOpenIcon from '@material-ui/icons/LockOpen';\r\nimport { HISTORY_TYPES, HISTORY_TYPES_LABELS } from './constants';\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\r\n\r\nconst HistoryItems = ({ id, name, open, onClose, core }) => {\r\n  const [data, setData] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  useMemo(() => {\r\n    const loadHistory = async () => {\r\n      setIsLoading(true);\r\n\r\n      try {\r\n        const response = await core.authenticatedRequest({\r\n          url: `/buzzer/${id}/history`,\r\n          responseType: 'json',\r\n          method: 'get',\r\n        });\r\n\r\n        setIsLoading(false);\r\n\r\n        if (!response.data.ok) {\r\n          return setError('Wrong server response');\r\n        }\r\n\r\n        setError(null);\r\n        setData(response.data.history);\r\n      } catch (e) {\r\n        setIsLoading(false);\r\n        setError('Cannot load history');\r\n\r\n        console.error(e);\r\n      }\r\n    };\r\n\r\n    loadHistory();\r\n  }, [\r\n    id,\r\n    core,\r\n  ]);\r\n\r\n  let history = (\r\n    <Box bgcolor=\"text.secondary\" color=\"background.paper\" p={2}>\r\n      History is empty\r\n    </Box>\r\n  );\r\n\r\n  if (isLoading) {\r\n    history = <div><CircularProgress/></div>;\r\n  } else if (error) {\r\n    history = (\r\n      <Box bgcolor=\"error.main\" color=\"background.paper\" p={2}>\r\n        {error}\r\n      </Box>\r\n    );\r\n  } else if (data && data.length) {\r\n    history = (\r\n      <List>\r\n        {data.map(historyItem =>\r\n          <ListItem key={historyItem.date}>\r\n            <ListItemAvatar>\r\n              <Avatar>\r\n                {historyItem.type === HISTORY_TYPES.RINGING ? <CallIcon/> : <LockOpenIcon/>}\r\n              </Avatar>\r\n            </ListItemAvatar>\r\n\r\n            <ListItemText\r\n              primary={`${name} was ${HISTORY_TYPES_LABELS[historyItem.type]}`}\r\n              secondary={new Date(historyItem.date * 1000).toLocaleString()}\r\n            />\r\n          </ListItem>,\r\n        )}\r\n      </List>\r\n    );\r\n  }\r\n\r\n  return history;\r\n};\r\n\r\nconst HistoryModal = ({ id, name, open, onClose, core }) => {\r\n  const theme = useTheme();\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'));\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      onClose={onClose}\r\n      fullScreen={fullScreen}\r\n      fullWidth\r\n      maxWidth={'md'}\r\n      aria-labelledby=\"buzzer-dialog-title\"\r\n    >\r\n      <DialogTitle id=\"buzzer-dialog-title\">History of {name}</DialogTitle>\r\n      <DialogContent>\r\n        <HistoryItems id={id} name={name} core={core}/>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onClose} color=\"primary\">\r\n          Close\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default HistoryModal;\r\n","import React, { useEffect, useState } from 'react';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Button from '@material-ui/core/Button';\r\nimport { makeStyles } from '@material-ui/core';\r\nimport { HISTORY_TYPES, HISTORY_TYPES_LABELS } from './constants';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  close: {\r\n    padding: theme.spacing(0.5),\r\n  },\r\n}));\r\n\r\nexport default ({ id, name, core, isRinging }) => {\r\n  const classes = useStyles();\r\n\r\n  const [isRingingOpen, setIsRingingOpen] = useState(isRinging);\r\n  const [msg, setMsg] = useState({\r\n    open: false,\r\n    text: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    const onUnlocked = (data) => {\r\n      const label = HISTORY_TYPES_LABELS[data ? HISTORY_TYPES.AUTO_UNLOCKED : HISTORY_TYPES.UNLOCKED];\r\n\r\n      setIsRingingOpen(false);\r\n      setMsg({\r\n        text: `${name} was ${label}`,\r\n        open: true,\r\n      });\r\n    };\r\n\r\n    const onAutoUnlockUpdate = (data) => {\r\n      let text = `Auto-unlock was disabled for ${name}`;\r\n\r\n      if (data) {\r\n        text = `${name} will be auto-unlocked for 5 min`;\r\n      }\r\n\r\n      setMsg({\r\n        open: true,\r\n        text,\r\n      });\r\n    };\r\n\r\n    core.subscribe(`buzzer/${id}/ringing`, setIsRingingOpen);\r\n    core.subscribe(`buzzer/${id}/unlocked`, onUnlocked);\r\n    core.subscribe(`buzzer/${id}/auto_unlock`, onAutoUnlockUpdate);\r\n\r\n    return () => {\r\n      core.unsubscribe(`buzzer/${id}/ringing`, setIsRingingOpen);\r\n      core.unsubscribe(`buzzer/${id}/unlocked`, onUnlocked);\r\n      core.unsubscribe(`buzzer/${id}/auto_unlock`, onAutoUnlockUpdate);\r\n    };\r\n  }, [id, name, core]);\r\n\r\n  const handleMsgClose = () => setMsg({\r\n    open: false,\r\n    text: null,\r\n  });\r\n\r\n  const handleUnlock = () => core.publishJson(`buzzer/${id}/unlock`, true);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Snackbar\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'right',\r\n        }}\r\n        open={msg.open}\r\n        autoHideDuration={5000}\r\n        onClose={handleMsgClose}\r\n        message={msg.text}\r\n        action={[\r\n          <IconButton\r\n            key=\"close\"\r\n            aria-label=\"Close\"\r\n            color=\"inherit\"\r\n            className={classes.close}\r\n            onClick={handleMsgClose}\r\n          >\r\n            <CloseIcon/>\r\n          </IconButton>,\r\n        ]}\r\n      />\r\n\r\n      <Snackbar\r\n        anchorOrigin={{\r\n          vertical: 'bottom',\r\n          horizontal: 'right',\r\n        }}\r\n        open={isRingingOpen}\r\n        message={<span id=\"message-id\">{name} is ringing</span>}\r\n        action={[\r\n          <Button\r\n            key=\"undo\"\r\n            color=\"secondary\"\r\n            size=\"small\"\r\n            onClick={handleUnlock}\r\n          >\r\n            UNLOCK\r\n          </Button>,\r\n        ]}\r\n      />\r\n    </React.Fragment>\r\n  );\r\n}\r\n","import Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport React, { useMemo, useState } from 'react';\r\nimport { makeStyles } from '@material-ui/core';\r\nimport Button from '@material-ui/core/Button';\r\nimport clsx from 'clsx';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport CallEnd from '@material-ui/icons/CallEnd';\r\nimport LockOpen from '@material-ui/icons/LockOpen';\r\nimport { red } from '@material-ui/core/colors';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  paper: {\r\n    padding: theme.spacing(1.3, 2),\r\n    borderRadius: theme.shape.borderRadius * 2,\r\n    cursor: 'pointer',\r\n    transition: '.5s',\r\n    background: '#fff',\r\n  },\r\n  isRinging: {\r\n    background: '#2196f3',\r\n    color: '#fff',\r\n  },\r\n  name: {\r\n    ...theme.typography.h6,\r\n    flexGrow: 1,\r\n    fontWeight: 400,\r\n  },\r\n  value: {\r\n    ...theme.typography.h6,\r\n  },\r\n  actions: {\r\n    display: 'flex',\r\n  },\r\n  unlockBtn: {\r\n    flexGrow: 1,\r\n    marginRight: theme.spacing(),\r\n  },\r\n  hangUpBtn: {\r\n    background: red[600],\r\n    '&:hover': {\r\n      background: red[700],\r\n    },\r\n  },\r\n}));\r\n\r\nfunction Widget({ core, id, name, onClick, ...props }) {\r\n  const classes = useStyles();\r\n\r\n  const [isAutoUnlock, setIsAutoUnlock] = useState(props.isAutoUnlock);\r\n  const [isRinging, setIsRinging] = useState(props.isRinging);\r\n\r\n  useMemo(() => {\r\n    const onRinging = (data) => {\r\n      setIsRinging(data);\r\n    };\r\n\r\n    const onUnlocked = () => {\r\n      setIsRinging(false);\r\n      setIsAutoUnlock(false);\r\n    };\r\n\r\n    const onAutoUnlockUpdate = (data) => {\r\n      setIsAutoUnlock(data);\r\n    };\r\n\r\n    core.subscribe(`buzzer/${id}/ringing`, onRinging);\r\n    core.subscribe(`buzzer/${id}/unlocked`, onUnlocked);\r\n    core.subscribe(`buzzer/${id}/auto_unlock`, onAutoUnlockUpdate);\r\n\r\n    return () => {\r\n      core.unsubscribe(`buzzer/${id}/ringing`, onRinging);\r\n      core.unsubscribe(`buzzer/${id}/unlocked`, onUnlocked);\r\n      core.unsubscribe(`buzzer/${id}/auto_unlock`, onAutoUnlockUpdate);\r\n    };\r\n  }, [id, core]);\r\n\r\n  const handleAutoUnlockChange = e => core.publishJson(`buzzer/${id}/auto_unlock/set`, e.target.checked);\r\n\r\n  const handleUnlockClick = unlock => () => core.publishJson(`buzzer/${id}/unlock`, unlock);\r\n\r\n  let controls;\r\n\r\n  if (isRinging) {\r\n    controls = (\r\n      <Grid item xs={6} className={classes.actions} onClick={e => e.stopPropagation()}>\r\n        <Button variant=\"contained\" color=\"primary\" className={classes.unlockBtn}\r\n                onClick={handleUnlockClick(true)}>\r\n          <LockOpen/>\r\n        </Button>\r\n        <Button variant=\"contained\" color=\"secondary\" className={classes.hangUpBtn}\r\n                onClick={handleUnlockClick(false)}>\r\n          <CallEnd/>\r\n        </Button>\r\n      </Grid>\r\n    );\r\n  } else {\r\n    controls = (\r\n      <FormControlLabel\r\n        control={\r\n          <Switch\r\n            checked={isAutoUnlock}\r\n            onChange={handleAutoUnlockChange}\r\n            size=\"small\"/>\r\n        }\r\n        onClick={e => e.stopPropagation()}\r\n        label=\"Auto\"\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Grid item sm={6} xs={12}>\r\n      <Paper className={clsx(classes.paper, {\r\n        [classes.isRinging]: isRinging,\r\n      })} onClick={onClick}>\r\n        <Grid container alignContent=\"space-between\">\r\n          <Grid item className={classes.name}>\r\n            {name}\r\n          </Grid>\r\n          {controls}\r\n        </Grid>\r\n      </Paper>\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default Widget;\r\n","import React, { useState } from 'react';\r\nimport Widget from './Widget';\r\nimport HistoryModal from './HistoryModal';\r\nimport Notification from './Notification';\r\n\r\nexport default (props) => {\r\n  const [openModal, setOpenModal] = useState(false);\r\n\r\n  return (\r\n    <React.Fragment>\r\n\r\n      <Widget {...props} onClick={() => setOpenModal(true)}/>\r\n\r\n      <HistoryModal open={openModal} onClose={() => setOpenModal(false)} {...props}/>\r\n\r\n      <Notification  {...props}/>\r\n\r\n    </React.Fragment>\r\n  );\r\n};\r\n"],"sourceRoot":""}